<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>disparate notes - Alex Volkov</title>
        <link rel="stylesheet" href="https://avolkov.github.io/theme/css/main.css" />
        <link href="https://avolkov.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="disparate notes Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://avolkov.github.io/">disparate notes </a></h1>
                <nav><ul>
                    <li><a href="https://avolkov.github.io/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://avolkov.github.io/running-jenkins-in-docker.html">Running Jenkins in Docker</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-10-28T10:19:00-04:00">
                Published: Fri 28 October 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/python.html">python</a> <a href="https://avolkov.github.io/tag/jenkins.html">jenkins</a> <a href="https://avolkov.github.io/tag/docker.html">docker</a> <a href="https://avolkov.github.io/tag/debian.html">debian</a> </p>
</footer><!-- /.post-info --><div class="section" id="requirements">
<h2>Requirements</h2>
<p>I went to an FSOSS 2016 <a class="footnote-reference" href="#id7" id="id1">[1]</a> conference and I found one talk on Jenkins to be particularly interesting.</p>
<p>I wanted to try Jenkins, without configuring Java on my laptop or setting up a VM. Using Jenkins docker container would be the easiest solution for this kind of problem.</p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites</h2>
<p>This article assumes Docker <a class="footnote-reference" href="#id8" id="id2">[2]</a> and Docker Compose <a class="footnote-reference" href="#id9" id="id3">[3]</a> have been set up.</p>
</div>
<div class="section" id="jenkins-container">
<h2>Jenkins container</h2>
<p>I used an official container built by Jenkins community <a class="footnote-reference" href="#id10" id="id4">[4]</a>.</p>
<p>The container comes with these settings:</p>
<ul class="simple">
<li>Jenkins server runs on ports 5000 and 8000</li>
<li>Jenkins settings saved to <strong>/var/jenkins_home</strong> and the directory is exposed as a docker volume</li>
<li>user / group ids are set to jenkins / jenkins with uid/gid set to 1001/1001.</li>
</ul>
</div>
<div class="section" id="volume-setup">
<h2>Volume Setup</h2>
<p>Docker volume settings, specify container directory mapping between host and container <a class="footnote-reference" href="#id11" id="id5">[5]</a>, allowing files generated  inside of the container to persist. The host system will store the data in <strong>/srv/dockercontainer/jenkins_home</strong>.</p>
<p>Following steps to set up docker volume and permission mapping on the host.</p>
<ol class="arabic simple">
<li>Create docker volume path on the host</li>
</ol>
<div class="highlight"><pre><span></span># mkdir /srv/dockercontainer/jenkins_home
</pre></div>
<ol class="arabic simple" start="2">
<li>Set up user/group mapping on the host.</li>
</ol>
<div class="highlight"><pre><span></span># groupadd --gid 20000 jenkins
# useradd --home-dir /srv/dockercontainer/jenkins_home \
   --uid 20000 --gid 20000 -s /bin/false -M jenkins
# chown -R jenkins:jenkins /srv/dockercontainer/jenkins_home
</pre></div>
</div>
<div class="section" id="docker-compose-file">
<h2>Docker compose file</h2>
<p><strong>docker-compose.yml</strong> specifies startup settings for Jenkins container.</p>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">version</span><span class="p p-Indicator">:</span> <span class="s">&#39;2&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">jenkins</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">jenkins</span>
    <span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="s">&quot;20000:20000&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">ports</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;5000:5000&quot;</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;8080:8080&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">volumes</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">/srv/dockercontainer/jenkins_home:/var/jenkins_home</span>
</pre></div>
<ul class="simple">
<li><strong>image</strong> -- the directive specifies container to use, in this case it's Jenkins container <a class="footnote-reference" href="#id10" id="id6">[4]</a>.</li>
<li><strong>user</strong> -- user/group mapping, 'uid:gid' from the container is mapped 'uid:gid' of the host.</li>
<li><strong>ports</strong> -- port mapping from the container to the host.</li>
<li><strong>volumes</strong> -- directory (docker volume) mapping, between the host and the container.</li>
</ul>
</div>
<div class="section" id="starting-up-the-container">
<h2>Starting up the container</h2>
<p>Go to the directory containing <strong>docker-compose.yml</strong>.</p>
<p>The following command starts the container in foreground, the container needs to be run in the foreground, as during the setup, system activation code for Jenkins will be printed to the console.</p>
<div class="highlight"><pre><span></span># docker-compose up
</pre></div>
<p>Open a browser and go to <strong>http://localhost:8080</strong>. Once initial setup is completed, stop the container with <em>Ctrl+C</em>, then start it as a daemon.</p>
<div class="highlight"><pre><span></span># docker-compose up -d
</pre></div>
<p>To shut down the container running in daemon mode, execute the following.</p>
<div class="highlight"><pre><span></span># docker-compose stop
</pre></div>
</div>
<div class="section" id="deleting-the-container">
<h2>Deleting the container</h2>
<p>To remove container setup, run the following command from the directory where <strong>docker-compose.yml</strong> is located.</p>
<div class="highlight"><pre><span></span># docker-compose rm jenkins
</pre></div>
<p>The data generated by Jenkins in docker container is saved in <strong>/srv/dockercontainer/jenkins_home</strong> with user 'jenkins' and group 'jenkins'.</p>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>FSOSS 2016 -- <a class="reference external" href="http://cdot.fsoss.ca/2016/">http://cdot.fsoss.ca/2016/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Docker installation on Debian -- <a class="reference external" href="https://docs.docker.com/engine/installation/linux/debian/">https://docs.docker.com/engine/installation/linux/debian/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td>Install Compose -- <a class="reference external" href="https://docs.docker.com/compose/install/">https://docs.docker.com/compose/install/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td>Official Jenkins Docker image -- <a class="reference external" href="https://hub.docker.com/_/jenkins/">https://hub.docker.com/_/jenkins/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td>Manage data in containers -- <a class="reference external" href="https://docs.docker.com/engine/tutorials/dockervolumes/">https://docs.docker.com/engine/tutorials/dockervolumes/</a></td></tr>
</tbody>
</table>
</div>
                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="https://avolkov.github.io/linting-and-declaration-lookup-for-python-with-sublime-text-3.html" rel="bookmark"
                           title="Permalink to Linting and declaration lookup for Python with Sublime Text 3">Linting and declaration lookup for Python with Sublime Text 3</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-10-23T22:18:00-04:00">
                Published: Sun 23 October 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/sublime.html">sublime</a> <a href="https://avolkov.github.io/tag/python.html">python</a> <a href="https://avolkov.github.io/tag/anaconda.html">anaconda</a> <a href="https://avolkov.github.io/tag/programming.html">programming</a> <a href="https://avolkov.github.io/tag/debian.html">debian</a> </p>
</footer><!-- /.post-info -->                <p>Recently I had to completely reset my Sublime Text 3 project settings and set everything up from scratch. I find the following two features the most important and need to be configured first:</p>
<ul class="simple">
<li>linting -- letting the computer keep track of consistent coding style</li>
<li>definition lookup -- letting the computer to look ...</li></ul>
                <a class="readmore" href="https://avolkov.github.io/linting-and-declaration-lookup-for-python-with-sublime-text-3.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://avolkov.github.io/debian-automated-install.html" rel="bookmark"
                           title="Permalink to Debian Automated Install">Debian Automated Install</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-10-17T21:44:00-04:00">
                Published: Mon 17 October 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/debian.html">debian</a> <a href="https://avolkov.github.io/tag/automation.html">automation</a> <a href="https://avolkov.github.io/tag/preseeding.html">preseeding</a> </p>
</footer><!-- /.post-info -->                <p>A few days ago in my part of the talk at GTALUG <a class="footnote-reference" href="#id7" id="id1">[1]</a>  I mentioned using Debian automated install <a class="footnote-reference" href="#id8" id="id2">[2]</a> to quickly bring up fully virtualized systems, as one of possible methods of system deployment or testing Ansible scripts.</p>
<p>This idea worked so well that I made a youtube video ...</p>
                <a class="readmore" href="https://avolkov.github.io/debian-automated-install.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://avolkov.github.io/hello.html" rel="bookmark"
                           title="Permalink to Hello world">Hello world</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-09-29T22:01:00-04:00">
                Published: Thu 29 September 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/pelican.html">pelican</a> <a href="https://avolkov.github.io/tag/web.html">web</a> <a href="https://avolkov.github.io/tag/rst.html">rst</a> <a href="https://avolkov.github.io/tag/github.html">github</a> <a href="https://avolkov.github.io/tag/first.html">first</a> </p>
</footer><!-- /.post-info -->                <p>A one way of learning restructured test is to start writing all of the things
down using rst. <a class="reference external" href="http://docs.getpelican.com/en/3.3.0/getting_started.html">Pelican</a>
is a rather nice static site generator.</p>
<p>A short tutorial on how to set up a blog with pelican, rst and github pages can be found
on <a class="reference external" href="http://www.circuidipity.com/pelican.html">Circuidipity</a>.</p>

                <a class="readmore" href="https://avolkov.github.io/hello.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://avolkov.github.io/thursdays-raspberry-pi-meetup.html" rel="bookmark"
                           title="Permalink to Thursday's Raspberry Pi meetup">Thursday's Raspberry Pi meetup</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-01-17T22:01:00-05:00">
                Published: Sun 17 January 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/raspberrypi.html">raspberrypi</a> <a href="https://avolkov.github.io/tag/opencv.html">opencv</a> <a href="https://avolkov.github.io/tag/gardening.html">gardening</a> </p>
</footer><!-- /.post-info -->                <p>I went to <a class="reference external" href="http://www.meetup.com/Raspberry-Pi/">Raspberry Pi meetup</a> on Thursday, January 14, and would like to share some links about the presentation I gave and things I brought with me.</p>
<ol class="arabic simple">
<li><a class="reference external" href="https://github.com/avolkov/rpi-opencv">Instructions on setting up OpenCV on Raspbian Jessie</a></li>
<li><a class="reference external" href="https://github.com/avolkov/my-first-automatic-door-man">My fork of Thiago's automatic doorman that works with PiCamera</a></li>
<li><a class="reference external" href="https://picamera.readthedocs.org/en/release-1.10/">Python library and ...</a></li></ol>
                <a class="readmore" href="https://avolkov.github.io/thursdays-raspberry-pi-meetup.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://avolkov.github.io/fun-of-premature-optimization.html" rel="bookmark"
                           title="Permalink to Fun of premature optimization">Fun of premature optimization</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-01-09T00:00:00-05:00">
                Published: Sat 09 January 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/python.html">python</a> <a href="https://avolkov.github.io/tag/apache-logs.html">apache logs</a> <a href="https://avolkov.github.io/tag/regular-expressions.html">regular expressions</a> <a href="https://avolkov.github.io/tag/performance.html">performance</a> </p>
</footer><!-- /.post-info -->                <p>Last week I deployed a redesigned website that included a new search feature, looking at the server logs I've noticed that users of the site use search. A lot.</p>
<p>I wanted to know more about what kind of questions end-users were asking, so I wrote a short program to ...</p>
                <a class="readmore" href="https://avolkov.github.io/fun-of-premature-optimization.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://avolkov.github.io/my-awesome-15k-mec-run.html" rel="bookmark"
                           title="Permalink to My awesome 15K MEC Run">My awesome 15K MEC Run</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-12-06T22:44:33-05:00">
                Published: Sun 06 December 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/running.html">running</a> </p>
</footer><!-- /.post-info -->                <p>These are my experiences from MEC Race Seven that happened on October 20, 2015. I posted this a while ago on EYTR page, now I finally got a couple of photos of it.</p>
<p>I'm still not sure how that's possible but I ran MEC 15K in 1:09 ...</p>
                <a class="readmore" href="https://avolkov.github.io/my-awesome-15k-mec-run.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://avolkov.github.io/raspberry-pi-wireless-config.html" rel="bookmark"
                           title="Permalink to Raspberry Pi Wireless config">Raspberry Pi Wireless config</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-12-06T00:57:30-05:00">
                Published: Sun 06 December 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://avolkov.github.io/author/alex-volkov.html">Alex Volkov</a>
        </address>
<p>In <a href="https://avolkov.github.io/category/misc.html">misc</a>.</p>
<p>tags: <a href="https://avolkov.github.io/tag/raspberrypi.html">raspberrypi</a> <a href="https://avolkov.github.io/tag/networking.html">networking</a> <a href="https://avolkov.github.io/tag/wireless.html">wireless</a> <a href="https://avolkov.github.io/tag/realtek.html">realtek</a> <a href="https://avolkov.github.io/tag/ralink.html">ralink</a> <a href="https://avolkov.github.io/tag/usb.html">usb</a> </p>
</footer><!-- /.post-info -->                <p>Here's working wireless configuration I use to connect my Raspberry Pis with USB wifi dongles to my home network.</p>
<p>I've been using Realtek RTL8188CUS and Ralink RT5370 based devices rated for 150Mbps.</p>
<p>Dongles based on Ralink chip have been working flawlessly, but I have experienced two issues with ...</p>
                <a class="readmore" href="https://avolkov.github.io/raspberry-pi-wireless-config.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://avolkov.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>